{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c0bd4ebb_1b78949a",
        "filename": "roles/preflight/tasks/prepare_custom_certificate.yml",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-07T22:06:10Z",
      "side": 1,
      "message": "When you say this CR is to allow preflight to run outside podman you mean that this Root CAs are required to run preflight binary?\n\nI\u0027m a bit hesitant to add CA Roots to the whole system ðŸ˜® I see they are using many (145) root CAs.\n\n  podman run -it --entrypoint cat quay.io/opdev/preflight:1.1.0-alpha2-linux-amd64 /etc/pki/tls/certs/ca-bundle.trust.crt | grep -c -- -B\n  145\n\nDo we need them all? can we extract just the one we really need?",
      "revId": "89267da6fefc98b1246f6991b8320ce98a717c21",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "10e134e3_1d219fd9",
        "filename": "roles/preflight/tasks/prepare_custom_certificate.yml",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 821
      },
      "writtenOn": "2022-03-07T22:16:59Z",
      "side": 1,
      "message": "The preflight_custom_ca is just the CA of the registry not all CA(s).\nWe add only this one on the jumphost.\n\nThe cabundle.stdout is all the CA(s), it used for podman. We are replacing ca-bundle.trust.crt with mount option, so we concatenate the custom CA with the initial file.",
      "parentUuid": "c0bd4ebb_1b78949a",
      "revId": "89267da6fefc98b1246f6991b8320ce98a717c21",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83ca4f1d_1f20bfa2",
        "filename": "roles/preflight/tasks/prepare_custom_certificate.yml",
        "patchSetId": 1
      },
      "lineNbr": 26,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-08T00:37:31Z",
      "side": 1,
      "message": "Ah! my bad, I thought preflight_custom_ca was the cabundle.\n\nWhere is the preflight_custom_ca defined?\n\n\nWith all that clarified, I believe these two tasks should not be in preflight, but earlier in the agent, perhaps pre-run?, because these changes to the jumphost are global. Preflight is not the only part that talks to the registry, wdyt?",
      "parentUuid": "10e134e3_1d219fd9",
      "revId": "89267da6fefc98b1246f6991b8320ce98a717c21",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}