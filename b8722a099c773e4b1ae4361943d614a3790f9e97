{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ef74e881_d788e5e9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-02T12:05:48Z",
      "side": 1,
      "message": "In the two previous tests, both fake-cnf and tnf-test-cnf pipelines are working, now using pullsecret file from DCI job instead of all_registries_creds for mirroring stuff.\nI\u0027ve scheduled an OCP vanilla job to confirm d-o-a also works, I\u0027ve done it in the pipeline PR",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4896cc72_d161c93b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "I\u0027d like to see what others think about tmp file vs /opt/cache. Let me know if any point needs clarification. Thanks!",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd2003b5_a25448be",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 130,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "I think we can save the use of this var by using tmp file for the secrets in disconnected env",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "663503e7_db1bf4f6",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 130,
      "author": {
        "id": 908
      },
      "writtenOn": "2022-03-03T22:48:36Z",
      "side": 1,
      "message": "yes, if we go for the temp location makes sense",
      "parentUuid": "fd2003b5_a25448be",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0b4ae949_40a23e9f",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 130,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "663503e7_db1bf4f6",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc6487cc_9339b3d4",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 131,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "partner_creds not only includes creds for their registries, it also contains the creds for the local registry.\n\nI\u0027m not sure I understand the note ðŸ˜®. Could you please explain what\u0027s the note about? ðŸ˜Š",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21cbb590_1b404eff",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 131,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "I\u0027ve changed this a little bit, I\u0027ve removed the second part of the note because it does not apply now.",
      "parentUuid": "cc6487cc_9339b3d4",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ba3bd390_9dd00ce5",
        "filename": "README.md",
        "patchSetId": 4
      },
      "lineNbr": 131,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-11T08:54:22Z",
      "side": 1,
      "message": "At this point, I\u0027ll mark this as solved.",
      "parentUuid": "21cbb590_1b404eff",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b65732a_cc739169",
        "filename": "group_vars/all",
        "patchSetId": 4
      },
      "lineNbr": 21,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "Could we save the secrets in a temp dir, instead of storing the secrets in /opt/cache and then clean at the end?",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "87d36ac6_ae5029be",
        "filename": "group_vars/all",
        "patchSetId": 4
      },
      "lineNbr": 21,
      "author": {
        "id": 908
      },
      "writtenOn": "2022-03-03T22:48:36Z",
      "side": 1,
      "message": "if we leave this in /opt/cache in our labs it works because our partner creds are the same, but assuming they are different per cluster then we\u0027ll start having conflicts because we are using the same name for the app-agent-pull-secret.txt \n\nOn the other hand the cleaning is always a good idea, assuming this could be used by a partner, but then we definitely need a temp location to avoid multiple jobs can affect each other. If a partner it\u0027s serious about security of data at rest, then this cleaning will be ideal. I vote for the cleaning in temp location.",
      "parentUuid": "6b65732a_cc739169",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5351e536_76ea81a1",
        "filename": "group_vars/all",
        "patchSetId": 4
      },
      "lineNbr": 21,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "yes, we can save the secrets in a temporary location rather than in cache, I will handle it\n\nby the way, we need to define here provision_cache_store, because it\u0027s being used in d-o-a-a since this change was merged: https://softwarefactory-project.io/r/c/dci-openshift-app-agent/+/24117, in fact some people has reported me that they needed to define the variable in order to make d-o-a-a jobs pass. I will also maintain in the README the entry for provision_cache_store. But I will do it in a separate change, as it is not needed here.",
      "parentUuid": "87d36ac6_ae5029be",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "536b4014_258cd41e",
        "filename": "plays/define_pullsecret.yml",
        "patchSetId": 4
      },
      "lineNbr": 5,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "I don\u0027t think we need a way to include more secrets, we have partner\u0027s for that, we just need those provided by the job data for must-gather at this point.",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41561ea5_a3e0cbb3",
        "filename": "plays/define_pullsecret.yml",
        "patchSetId": 4
      },
      "lineNbr": 5,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "okey, removing \"| combine(openshift_secret | default({}), recursive\u003dTrue)\". I\u0027ve just put it because it was how it is defined in d-o-a, but yes, it\u0027s not needed here",
      "parentUuid": "536b4014_258cd41e",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f22b7e86_9f35696f",
        "filename": "plays/define_pullsecret.yml",
        "patchSetId": 4
      },
      "lineNbr": 8,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "I think we could use a tmp file here",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75d529f5_73532d79",
        "filename": "plays/define_pullsecret.yml",
        "patchSetId": 4
      },
      "lineNbr": 8,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f22b7e86_9f35696f",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c15bae8_884f3738",
        "filename": "plays/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 33,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "Here we will need to use both creds, pullsecrets to pull and partner\u0027s creds to push, e.g.\n\n--src-authfile {{ pullsecret_file }}\n--dst-authfile {{ partner_creds }}",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83cc4e1f_8440eb1f",
        "filename": "plays/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 33,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "What I am going to do is include the creds to be used by skopeo in the define_pullsecret.yml file, because it may happen that partner_creds is not provided, then we still need to use the pullsecret_file as unique authfile. Do you think it\u0027s fine in that way?",
      "parentUuid": "1c15bae8_884f3738",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "93b9c5c1_18bc667d",
        "filename": "plays/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 33,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-11T08:54:22Z",
      "side": 1,
      "message": "With the usage of a single pullsecret file, this is no longer needed",
      "parentUuid": "83cc4e1f_8440eb1f",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c2d3276_51db80fa",
        "filename": "roles/cnf-cert/tasks/save-images.yml",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "I donÂ´t think we need creds for pulling here, but only to push into the local repo, then partner_creds are needed, e.g.\n\n--dest-authfile {{ partner_creds }}",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a43250d_f1ba5f42",
        "filename": "roles/cnf-cert/tasks/save-images.yml",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "I\u0027ve put the same than in must-gather mirroring, because it may happen, again, that partner_creds is not set",
      "parentUuid": "4c2d3276_51db80fa",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0b7c172a_3ae65460",
        "filename": "roles/cnf-cert/tasks/save-images.yml",
        "patchSetId": 4
      },
      "lineNbr": 6,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-11T08:54:22Z",
      "side": 1,
      "message": "With the usage of a single pullsecret file, this is no longer needed",
      "parentUuid": "7a43250d_f1ba5f42",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39712b9f_5105ea5a",
        "filename": "roles/cnf-cert/tasks/save-images.yml",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "ditto",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7c653d9_9551190d",
        "filename": "roles/cnf-cert/tasks/save-images.yml",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "39712b9f_5105ea5a",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9949aa9e_9aa9cfd4",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "since provisionhost_registry is defined based on the conditions of dci_disconnected, you could simply do:\n\n\"{{ ( provisionhost_registry|length ) | ternary(provisionhost_registry, \u0027quay.io\u0027) }}\"",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7caf7ed4_aab08500",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "good catch :)",
      "parentUuid": "9949aa9e_9aa9cfd4",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f992127_0b9eea79",
        "filename": "samples/basic_example/hooks/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 667
      },
      "writtenOn": "2022-03-03T19:02:28Z",
      "side": 1,
      "message": "The partner_creds are needed in here as those are used to push to the local registry, e.g.\n\n--dst-authfile {{ partner_creds }}\n\nThe job worked because those creds are cached, but the creds you used does not have them:\n\n\u003c/opt/cache/app-agent-pull-secret.txt  jq \u0027.auths.\"registry.dfwt5g.lab:4443\" | length\u0027\n0\n\nvs\n\n$ \u003c/var/lib/dci/service-configs/pull-secrets/partner_config.json jq \u0027.auths.\"registry.dfwt5g.lab:4443\" | length\u0027\n2",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6f597ca_90161ba5",
        "filename": "samples/basic_example/hooks/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 908
      },
      "writtenOn": "2022-03-03T22:48:36Z",
      "side": 1,
      "message": "interesting about the cache thing, Beto mentioned too the other day, it\u0027s good and bad :) at the same time.",
      "parentUuid": "6f992127_0b9eea79",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eaf55dca_4ae7f0ca",
        "filename": "samples/basic_example/hooks/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-07T09:48:52Z",
      "side": 1,
      "message": "I will do the same than in the other cases, because again, by default, partner_creds is an empty value. So, in that case, if partner_creds is not provided, it is supposed that pull_secret file should have the creds to access to the registries.",
      "parentUuid": "a6f597ca_90161ba5",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a97a4b15_27cc0673",
        "filename": "samples/basic_example/hooks/pre-run.yml",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-03-11T08:54:22Z",
      "side": 1,
      "message": "With the usage of a single pullsecret file, this is no longer needed",
      "parentUuid": "eaf55dca_4ae7f0ca",
      "revId": "b8722a099c773e4b1ae4361943d614a3790f9e97",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}