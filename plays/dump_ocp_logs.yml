---

- block:
    - name: Get OCP logs from namespace
      include_role:
        name: get-logs-from-namespace
      vars:
        get_logs_ns: "{{ dci_openshift_app_ns }}"
        get_logs_folder: "{{ job_logs.path }}"
      when: dci_openshift_app_ns is defined

    # TODO modify variable names related to inventory, to check how to reference to the correct cluster and what to do if we are in a different env than dallas
    - name: Get logs from OCP deployment
      environment:
        - DCI_MUST_GATHER_IMAGES: '{{ dci_must_gather_images | default(["registry.redhat.io/openshift4/ose-must-gather"]) | join(" ") }}'
      script: ./scripts/get-logs "{{ hostvars[groups['provisioner'][0]]['ansible_user'] }}@{{ groups['provisioner'][0] }}" "{{ job_logs.path }}" "{{ groups['masters'] }}"
      delegate_to: localhost
  ignore_errors: true

...
