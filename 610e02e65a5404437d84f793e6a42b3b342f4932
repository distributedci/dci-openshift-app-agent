{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "34a21202_056c22ee",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-02-23T13:59:06Z",
      "side": 1,
      "message": "In this job, where I removed all_registries_creds variable from the inventory to check if default(\"\") works, we can confirm the behaviour is correct: default(\"\") is taken and mirroring tasks were not executed: https://www.distributed-ci.io/jobs/d7ce8588-9c56-4dff-9203-45602ffa404f/jobStates#b77b1a6b-eaa4-440f-b0c9-c46e52e72448:file26\n\nAnd then, in the last two examples, now using all_registries_creds again and pointing to /opt/cache, we can confirm fake-cnf (https://www.distributed-ci.io/jobs/85b9c9d7-690f-498f-b78b-0d37dd10401a/jobStates#10ba5bd6-5b1d-45e7-830f-5df349d12ff2:file26) and tnf-test-cnf (https://www.distributed-ci.io/jobs/88868c22-c6f0-4ce7-b13a-256a7a0eef39/jobStates#049d6f25-d041-436f-a17d-57381d5abc89:file4) are working fine and the mirror tasks also worked.",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b2b33cc6_68836a52",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 908
      },
      "writtenOn": "2022-02-23T17:25:09Z",
      "side": 1,
      "message": "Ramon, thanks for organizing this, I\u0027m just curious if you have a job where the vars in the inventory are not taken because all_registries_creds in the group_vars take precedence? I\u0027m reading the doc[1], and for me the inventory file takes precedence over group_vars, I\u0027m ok to merge this, I\u0027m just not sure if the var is group_vars dir is really a problem.\n\n[1] https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#variable-precedence-where-should-i-put-a-variable ",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fffac010_bae82bf5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-02-24T09:26:18Z",
      "side": 1,
      "message": "Hi Ramon, thank you for the CR.\n\n\u003e So, if we intend to define all_registries_creds variables only in the inventory\n\nFor the moment, we define all_registries_creds in the pipeline. Why do we plan to change it and move to the inventory? ",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "040b7a80_e0521adf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-02-24T11:27:46Z",
      "side": 1,
      "message": "Hi Manuel, not sure, look at this post: https://medium.com/opsops/changing-variable-precedence-in-ansible-a86c0c8373d7 and this docs link: https://docs.ansible.com/ansible/latest/reference_appendices/config.html#variable-precedence",
      "parentUuid": "b2b33cc6_68836a52",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6c43ca75_12db684d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-02-24T11:41:11Z",
      "side": 1,
      "message": "Here you have an example Manuel: https://www.distributed-ci.io/jobs/34692b88-0038-4674-8ac4-e079216c9f39/jobStates#7ebcf30b-84a1-4fe0-92a3-1080b06f5a66:file44, in this case, you can see all_registries_creds is empty in case we only define it in the inventories.\n\nI think, taking Ansible docs as base, the inventory variable is in group 4. inventory group_vars/all, with less priority than 5. playbook group_vars/all. I think this because, for the app-agent, we define the inventory vars under all.vars: https://github.com/dci-labs/inventories/blob/master/dallas/8nodes/cluster5-post.yml#L1. Or, according to what Tatiana shared, our case would be \"inventory file specificgroup:vars (‘groups_inventory’)\", which also has less priority than group_vars/all",
      "parentUuid": "040b7a80_e0521adf",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d46c7742_cfc77f28",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-02-24T11:41:11Z",
      "side": 1,
      "message": "Resolving questions. Moreover, although this change may be related to https://softwarefactory-project.io/r/c/dci-openshift-agent/+/24113, https://github.com/dci-labs/dallas-pipelines/pull/249 and https://github.com/dci-labs/inventories/pull/81, this can be safely merged if we agree.",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "12838d0b_faba258b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 800
      },
      "writtenOn": "2022-02-24T11:41:11Z",
      "side": 1,
      "message": "Already discussed it, it is because of https://github.com/dci-labs/dallas-pipelines/pull/249 and https://github.com/dci-labs/inventories/pull/81. The idea is to avoid having the same variable in two different places. And if the registry_creds depends on the pull-secret and the pull-secret is different for each cluster, then we can better obtain the info from the inventories rather than from the pipelines.",
      "parentUuid": "fffac010_bae82bf5",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c6e7a1a5_0d9468b7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 908
      },
      "writtenOn": "2022-02-25T03:23:10Z",
      "side": 1,
      "message": "@Ramon @Tatiana, thanks for the explanation and examples, I had troubles identifying the groups in the ansible doc. Now is clear.",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45efd963_28925f2b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 938
      },
      "writtenOn": "2022-02-25T08:50:24Z",
      "side": 1,
      "message": "LGTM, but let\u0027s wait to merge until the sync with Tony on Monday",
      "revId": "610e02e65a5404437d84f793e6a42b3b342f4932",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}