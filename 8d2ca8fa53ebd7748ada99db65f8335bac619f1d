{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "82669536_50eb107b",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 1056
      },
      "writtenOn": "2023-01-04T17:05:26Z",
      "side": 0,
      "message": "I think we need to proceeds with three stages for compatibility:\n- Add new feature and mark old way as deprecated.\n- Wait everybody use the new way.\n- Remove the deprecated way from the code.",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1f78464_fe42eb8d",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 908
      },
      "writtenOn": "2023-01-04T19:19:08Z",
      "side": 0,
      "message": "I\u0027m ok with the change, but I like David\u0027s three stages to add the new feature if is not too complicated. I\u0027m not sure if many partners use it, but just to play safe and use good practices to replace features.",
      "parentUuid": "82669536_50eb107b",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c42885e5_123a2f66",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 800
      },
      "writtenOn": "2023-01-05T09:12:43Z",
      "side": 0,
      "message": "I\u0027ve included a task before running tnf where I redefine tnf_env_vars to include the old variables used for tnf environment variables only in the case that tnf_env_vars has not been overriden, to keep backwards compatibility. I\u0027ll test this on libvirt, while I test tnf_env_vars in dallas.",
      "parentUuid": "d1f78464_fe42eb8d",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9eb761d7_fc016bfd",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 1056
      },
      "writtenOn": "2023-01-05T15:12:07Z",
      "side": 0,
      "message": "Did you change the code, I don\u0027t see the change.",
      "parentUuid": "c42885e5_123a2f66",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "897d4ef0_5ec65518",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 800
      },
      "writtenOn": "2023-01-05T15:29:00Z",
      "side": 0,
      "message": "The new task called \"Redefine tnf_env_vars if empty using default environment variables\" will do the same without needing to explicitly export the variables, as we use `environment` field when calling to `shell` module. You can see the change here: https://softwarefactory-project.io/r/c/dci-openshift-app-agent/+/27099/5..6",
      "parentUuid": "9eb761d7_fc016bfd",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4ffae690_b9820831",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 1056
      },
      "writtenOn": "2023-01-05T15:40:39Z",
      "side": 0,
      "message": "Is the compatibility change part of the PR? I don\u0027t see it. The link goes to the PR, it is broken, I guess.",
      "parentUuid": "897d4ef0_5ec65518",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "448df798_8b334cdc",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 800
      },
      "writtenOn": "2023-01-05T15:57:39Z",
      "side": 0,
      "message": "This is the code that ensures the backwards compatibility, as I said:\n\n```\n# Task to be deleted when removing backwards compatibility with env vars usage.\n- name: Redefine tnf_env_vars if empty using default environment variables\n  set_fact:\n    tnf_env_vars:\n      TNF_NON_INTRUSIVE_ONLY: \"{{ tnf_non_intrusive_only }}\"\n      TNF_RUN_CFD_TEST: \"{{ tnf_run_cfd_test }}\"\n      TNF_LOG_LEVEL: \"{{ tnf_log_level }}\"\n  when: tnf_env_vars|length \u003d\u003d 0\n```\n\nwith this, and with this:\n\n```\n# The task automatically append TNF_PARTNER_REPO and TNF_IMAGE environment variables to tnf_env_vars\n- name: Run the CNF Test Suite\n  vars:\n    tnf_partner_repo: \"{{ ( provisionhost_registry|length ) | ternary(provisionhost_registry, \u0027quay.io\u0027) }}/testnetworkfunction\"\n  environment: \"{{ tnf_env_vars | combine({\u0027TNF_PARTNER_REPO\u0027: tnf_partner_repo, \u0027TNF_IMAGE\u0027: tnf_image}) }}\"\n```\n\nwe don\u0027t need to do export anymore",
      "parentUuid": "4ffae690_b9820831",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "88f221ea_397c488b",
        "filename": "roles/cnf-cert/tasks/tests.yml",
        "patchSetId": 4
      },
      "lineNbr": 237,
      "author": {
        "id": 1056
      },
      "writtenOn": "2023-01-05T16:47:17Z",
      "side": 0,
      "message": "Okey, cool, let\u0027s do it :-)",
      "parentUuid": "448df798_8b334cdc",
      "range": {
        "startLine": 232,
        "startChar": 0,
        "endLine": 237,
        "endChar": 0
      },
      "revId": "8d2ca8fa53ebd7748ada99db65f8335bac619f1d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0"
    }
  ]
}